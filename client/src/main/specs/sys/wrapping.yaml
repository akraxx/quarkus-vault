name: Wrapping
category: sys
mountable: false
basePath: sys

operations:

- name: lookup
  method: POST
  path: wrapping/lookup
  bodyFrom: [token]
  parameters:
  - name: token
    type: String
  result:
    kind: leased
    data:
    - name: creationPath
      type: String
    - name: creationTime
      type: java.time.OffsetDateTime
    - name: creationTtl
      type: Long


- name: rewrap
  method: POST
  path: wrapping/rewrap
  bodyFrom: [token]
  parameters:
  - name: token
    type: String
  result:
    kind: leased

- name: unwrap
  method: POST
  path: wrapping/unwrap
  result:
    kind: leased
    dataType: java.util.Map<String, Object>


- name: unwrap
  method: POST
  path: wrapping/unwrap
  bodyFrom: [token]
  authenticated: false
  parameters:
  - name: token
    type: String
  result:
    kind: leased
    dataType: java.util.Map<String, Object>



- name: wrap
  method: POST
  path: wrapping/wrap
  wrapTTLFrom: wrapTtl
  parameters:
  - name: data
    type: java.util.Map<String, Object>
  - name: wrapTtl
    type: java.time.Duration
  result:
    kind: leased
